{
  "version": 3,
  "sources": ["browser-route-module:/Users/dom/Documents/GitHub/dominicklee.net/app/routes/admin/$edit.tsx?browser", "../../../../app/routes/admin/$edit.tsx"],
  "sourcesContent": ["export { default } from \"/Users/dom/Documents/GitHub/dominicklee.net/app/routes/admin/$edit.tsx\";", "import invariant from 'tiny-invariant';\nimport { getPostEdit } from '~/post';\nimport {\n  redirect,\n  Form,\n  useActionData,\n  useTransition,\n  useLoaderData,\n} from 'remix';\nimport { updatePost } from '~/post';\nimport Editor from '~/components/editor.client';\nimport { ClientOnly } from 'remix-utils';\nimport { useState } from 'react';\nconst axios = require('axios').default;\n\nexport let loader = async ({ params }) => {\n  invariant(params.edit, 'expected params.edit');\n  return getPostEdit(params.edit);\n};\n\n// NOTE: This function submits the form data for a new post\nexport let action = async ({ request }) => {\n  // Get the form data\n  let formData = await request.formData();\n  // Parse the form data\n  let title = formData.get('title');\n  let coverUrl = formData.get('coverUrl');\n  let slug = formData.get('slug');\n  let description = formData.get('description');\n  let editorjs = formData.get('editorjs');\n  let id = formData.get('id');\n\n  console.log('Check the cover image');\n  console.log(coverUrl);\n\n  // Error handling\n  let errors: any = {};\n  if (!title) errors.title = true;\n  if (!coverUrl) errors.coverUrl = true;\n  if (!slug) errors.slug = true;\n  if (!description) errors.description = true;\n  if (!editorjs) errors.editorjs = true;\n\n  if (Object.keys(errors).length) {\n    return errors;\n  }\n\n  await updatePost({ id, title, coverUrl, slug, description, editorjs });\n\n  return redirect('/admin');\n};\n\nexport default function PostSlug() {\n  let errors = useActionData();\n  let transition = useTransition();\n  let post = useLoaderData();\n  const [savedData, setSavedData] = useState('{}');\n  const [coverUrl, setCoverUrl] = useState(post.coverUrl);\n  const [isSelected, setIsSelected] = useState(false);\n  const [selectedFile, setSelectedFile] = useState('');\n\n  async function imageUpload(event: any) {\n    let file = event.target.files[0];\n    const responseFromAWS = await axios({\n      method: 'post',\n      url: '/.netlify/functions/uploadImage',\n      data: file.name,\n    });\n    console.log(responseFromAWS.data.url);\n    console.log('ATTEMPTING PUT');\n    const putResponse = await fetch(responseFromAWS.data.url, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n      body: file,\n    });\n    const imageUrl = putResponse.url.split('?')[0];\n    setCoverUrl(imageUrl);\n    setIsSelected(true);\n  }\n\n  return (\n    <Form reloadDocument method='post'>\n      <div className='edit-post-container'>\n        <h2>Edit Post</h2>\n        <img className='cover-preview' src={coverUrl} />\n        <p>\n          <label htmlFor=''>\n            Post Title: {errors?.title && <em>Title is required</em>}{' '}\n            <input type='text' name='title' defaultValue={post.title} />\n          </label>\n        </p>\n        <p>\n          <label htmlFor=''>\n            Post Cover: {errors?.coverUrl && <em>Cover is required</em>}{' '}\n            <input\n              type='file'\n              name='cover'\n              value={selectedFile}\n              onChange={imageUpload}\n            />\n          </label>\n        </p>\n        <p>\n          <label htmlFor=''>\n            {' '}\n            Post Slug: {errors?.slug && <em>Slug is required</em>}\n            <input\n              defaultValue={post.slug}\n              id='slugInput'\n              type='text'\n              name='slug'\n            />\n          </label>\n        </p>\n        <p>\n          Insert Description:\n          <label htmlFor=''>\n            <input defaultValue={post.description} name='description' id='' />\n          </label>{' '}\n          {errors?.description && <em>Description is required</em>}\n          <br />\n          <ClientOnly>\n            {() => (\n              <Editor\n                previousData={post.editorjs}\n                saveOutput={savedData}\n                save={(savedData: any) => setSavedData(savedData)}\n              />\n            )}\n          </ClientOnly>\n        </p>\n        <p className='savePost'>\n          <button type='submit'>\n            {transition.submission ? 'Saving...' : 'Save Post'}\n          </button>\n        </p>\n        <input\n          defaultValue={post.editorjs}\n          name='editorjs'\n          value={savedData}\n          className='hiddenEditorField'\n        />\n        <label htmlFor=''>\n          <input\n            className='hidden'\n            type='text'\n            name='coverUrl'\n            defaultValue={coverUrl}\n          />\n        </label>\n        <input className='hidden' name='id' value={post.id}></input>\n      </div>\n    </Form>\n  );\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;AAAA;;;ACAA;AAYA,mBAAyB;AACzB,IAAM,QAAQ,gBAAiB;AAuChB,oBAAoB;AACjC,MAAI,SAAS;AACb,MAAI,aAAa;AACjB,MAAI,OAAO;AACX,QAAM,CAAC,WAAW,gBAAgB,2BAAS;AAC3C,QAAM,CAAC,UAAU,eAAe,2BAAS,KAAK;AAC9C,QAAM,CAAC,YAAY,iBAAiB,2BAAS;AAC7C,QAAM,CAAC,cAAc,mBAAmB,2BAAS;AAEjD,6BAA2B,OAAY;AACrC,QAAI,OAAO,MAAM,OAAO,MAAM;AAC9B,UAAM,kBAAkB,MAAM,MAAM;AAAA,MAClC,QAAQ;AAAA,MACR,KAAK;AAAA,MACL,MAAM,KAAK;AAAA;AAEb,YAAQ,IAAI,gBAAgB,KAAK;AACjC,YAAQ,IAAI;AACZ,UAAM,cAAc,MAAM,MAAM,gBAAgB,KAAK,KAAK;AAAA,MACxD,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA;AAAA,MAElB,MAAM;AAAA;AAER,UAAM,WAAW,YAAY,IAAI,MAAM,KAAK;AAC5C,gBAAY;AACZ,kBAAc;AAAA;AAGhB,SACE,oCAAC,MAAD;AAAA,IAAM,gBAAc;AAAA,IAAC,QAAO;AAAA,KAC1B,oCAAC,OAAD;AAAA,IAAK,WAAU;AAAA,KACb,oCAAC,MAAD,MAAI,cACJ,oCAAC,OAAD;AAAA,IAAK,WAAU;AAAA,IAAgB,KAAK;AAAA,MACpC,oCAAC,KAAD,MACE,oCAAC,SAAD;AAAA,IAAO,SAAQ;AAAA,KAAG,gBACH,kCAAQ,UAAS,oCAAC,MAAD,MAAI,sBAAwB,KAC1D,oCAAC,SAAD;AAAA,IAAO,MAAK;AAAA,IAAO,MAAK;AAAA,IAAQ,cAAc,KAAK;AAAA,QAGvD,oCAAC,KAAD,MACE,oCAAC,SAAD;AAAA,IAAO,SAAQ;AAAA,KAAG,gBACH,kCAAQ,aAAY,oCAAC,MAAD,MAAI,sBAAwB,KAC7D,oCAAC,SAAD;AAAA,IACE,MAAK;AAAA,IACL,MAAK;AAAA,IACL,OAAO;AAAA,IACP,UAAU;AAAA,QAIhB,oCAAC,KAAD,MACE,oCAAC,SAAD;AAAA,IAAO,SAAQ;AAAA,KACZ,KAAI,eACO,kCAAQ,SAAQ,oCAAC,MAAD,MAAI,qBAChC,oCAAC,SAAD;AAAA,IACE,cAAc,KAAK;AAAA,IACnB,IAAG;AAAA,IACH,MAAK;AAAA,IACL,MAAK;AAAA,QAIX,oCAAC,KAAD,MAAG,uBAED,oCAAC,SAAD;AAAA,IAAO,SAAQ;AAAA,KACb,oCAAC,SAAD;AAAA,IAAO,cAAc,KAAK;AAAA,IAAa,MAAK;AAAA,IAAc,IAAG;AAAA,OACtD,KACR,kCAAQ,gBAAe,oCAAC,MAAD,MAAI,4BAC5B,oCAAC,MAAD,OACA,oCAAC,YAAD,MACG,MACC,oCAAC,QAAD;AAAA,IACE,cAAc,KAAK;AAAA,IACnB,YAAY;AAAA,IACZ,MAAM,CAAC,eAAmB,aAAa;AAAA,QAK/C,oCAAC,KAAD;AAAA,IAAG,WAAU;AAAA,KACX,oCAAC,UAAD;AAAA,IAAQ,MAAK;AAAA,KACV,WAAW,aAAa,cAAc,eAG3C,oCAAC,SAAD;AAAA,IACE,cAAc,KAAK;AAAA,IACnB,MAAK;AAAA,IACL,OAAO;AAAA,IACP,WAAU;AAAA,MAEZ,oCAAC,SAAD;AAAA,IAAO,SAAQ;AAAA,KACb,oCAAC,SAAD;AAAA,IACE,WAAU;AAAA,IACV,MAAK;AAAA,IACL,MAAK;AAAA,IACL,cAAc;AAAA,OAGlB,oCAAC,SAAD;AAAA,IAAO,WAAU;AAAA,IAAS,MAAK;AAAA,IAAK,OAAO,KAAK;AAAA;AAAA;",
  "names": []
}
